pipeline {
    agent any

    stages {
        stage('Build') {
            steps {
                sh 'docker build -t maks2531/makswebsite .'   
            }
        }
    }
        stage('Push image') {
        withDockerRegistry([ credentialsId: "maks2531", url: "https://index.docker.io/v1/" ]) {
        bat "docker push maks2531/makswebsite"
                }
            }
        }
        stage('Clean') {
            steps {
                sh 'docker rmi -f $(docker images -aq)'
            }
        }
    }
}


